---
import Layout from '../layouts/Layout.astro';
import Register from '../components/Register.astro';

const cookies = Object.fromEntries(
  (Astro.request.headers.get('cookie') ?? '').split('; ').map(c => c.split('=').map(decodeURIComponent))
);
const user = cookies.user || null;

if (user) {
  return Astro.redirect('/Profile');
}

const url = new URL(Astro.request.url);
const error = url.searchParams.get('error');
const success = url.searchParams.get('success');
---

<Layout>
  <a href="/" style="color: #4f46e5;">⬅ Home</a>
  <h1>Register</h1>

  {success === '1' && <p style="color: green;">✅ Registration successful! Please login.</p>}
  {error && <p style="color: red;">⚠️ {decodeURIComponent(error)}</p>}

  <Register />
</Layout>
